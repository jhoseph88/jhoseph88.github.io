<!DOCTYPE html>
<html>

<head>
  <meta charset= "utf-8">
  <title>Game of Life</title>
  <script type="application/javascript">
    function draw() {
      var canvas = document.getElementById('canvas');
      if (canvas.getContext){
       var prob_life = window.prompt("Enter the initial probability of a live cell to generate seed (enter a decimal number, as in 0.2 or .2):");
        var ctx = canvas.getContext('2d');
        ctx.strokeStyle = 'rgb(200,200,200)';  
        ctx.fillStyle = 'rgba(200,200,200,.5)';   
        ctx.lineWidth = 1;
        ctx.beginPath();
        //draw grid
        for (var i = 25.5; i < 550; i += 25) {
          ctx.moveTo(0, i);
          ctx.lineTo(550, i);
          ctx.stroke();

          ctx.moveTo(i, 0);
          ctx.lineTo(i, 550);
          ctx.stroke();
        }
        seed(prob_life, 22, ctx);
      }
    }//draw
    //draw/build the initial conditions ("seed") depending on the user's
    //input of the probability of cell life
    function seed(prob_life, dims, ctx) {
      //2d array universe of cells (true means alive, false means dead)
      var uni = new Array(dims);
      for (var i = 0; i < dims; ++i) {
        uni[i] = new Array(dims);
      }
      for (var i = 0; i < dims; ++i) {
        for (var j = 0; j < dims; ++j) {
          if (Math.random() < prob_life) {
            uni[i][j] = true;
            ctx.fillRect(i * 25 + .5, j * 25 + .5, 25, 25)
          }
          else {
            uni[i][j] = false;
          }
        }
      }
      setInterval(life, 500, ctx, uni);
    }//seed
    function life(ctx, universe) {
      //to_change will be a 2d array with the first dimension as the
      //x coordinate of the cell, the second dimension as the y coordinate,
      //and the key will be true if the cell is to die after the round and
      //false if the cell is dead and will come alive after the round.
      var to_change = new Array(universe.length);
      for (var i = 0; i < universe.length; ++i) {
        to_change[i] = new Array(universe.length);
      }
      for (var i = 0; i < universe.length; ++i) {
        for (var j = 0; j < universe.length; ++j) {
          var neighbor_count = 0;
          if (i - 1 >= 0)  {
            //northwest neighbor?
            if (j - 1 >= 0 && (universe[i - 1][j - 1] == true) ) {
                neighbor_count++;
            }//west neighbor?
            if (universe[i - 1][j] == true) {
              neighbor_count++;
            }
          }
          if (j - 1 >= 0) {
            //northeast neighbor?
            if (i + 1 < universe.length && (universe[i + 1][j - 1] == true) ) {
              neighbor_count++;
            }//north neighbor?
            if (universe[i][j - 1] == true) {
              neighbor_count++;
            }
          }
          if (i + 1 < universe.length) {
            //southeast neighbor?
            if (j + 1 < universe.length && (universe[i + 1][j + 1] == true) ) {
              ++neighbor_count;
            }//east neighbor?
            if (universe[i + 1][j] == true) {
              ++neighbor_count;
            }
          }
          if (j + 1 < universe.length) {
            //southwest neighbor?
            if (i - 1 >= 0 && (universe[i - 1][j + 1] == true) ) {
              ++neighbor_count;
            }//south neighbor?
            if (universe[i][j + 1] == true) {
              ++neighbor_count;
            }
          }
          //dies by underpopulation if less than two neighbors
          //or by overpopulation if more than three neighbors
          if ( (universe[i][j] == true) && 
               (neighbor_count < 2 || neighbor_count > 3) ) {
            to_change[i][j] = true;
          }//comes alive if exactly three neighbors (reproduction)
          else if (universe[i][j] == false && neighbor_count == 3) {
            to_change[i][j] = false;
          }
        }
      }
      for (var i = 0; i < to_change.length; ++i) {
        for (var j = 0; j < to_change.length; ++j) {
          //if deemed dead after the round, change the cell to false in
          //universe (signifying cell death) and clear it from the grid
          if (to_change[i][j] == true) {
            universe[i][j] = false;
            ctx.clearRect(i * 25+ .5, j * 25 + .5, 24, 24);
          }//if the cell is to come alive after the round, set the cell to
          //true in the universe (signifying cell birth) and color it in in
          //the grid
          else if (to_change[i][j] == false) {
            universe[i][j] = true;
            ctx.fillRect(i * 25 + .5, j * 25 + .5, 25.5, 25.5);
          }
        }
      }
    }
  </script>
  <style type="text/css">
    canvas { border: 1px solid black; }
  </style>
</head>

<body onload="draw();">
  <canvas id="canvas" width="550" height="550"></canvas>
</body>
</html>
